<html>

<% include partials/navbar.ejs %>

<head>
  <% include partials/head.ejs %>
</head>

<body>
  <script type='text/javascript' src='https://kitchwww.github.io/midi/midi.js'></script>


  <div class="container">
    <div class="row">


      <div class='col-md-5 offset-md-4'>

        <div class="shadow p-3 mb-5 bg-white rounded">

          <!-- Title -->


          <div class="card">
            <div class="card-header">
               <h1> <%= data.trackName %></h1>
            </div>
            <img class="card-img-top" src='data:image/png;base64, <%= data.image %>' alt="Card image cap">
            <div class="card-body">
              <h2>  Artist: <%= data.artistName %></h2>
              <h2> Tempo: <%= data.tempo %></h2>
              <h2> Key: <%= data.key %></h2>

              <a href="#" onClick="MIDIjs.play('path/to/yoursong.midi');">Play My Song</a>
              <p style="margin-bottom:10%;"> </p>
              <audio controls autoplay loop>
                <source src="data:audio/mid;base64,<%=data.midi%>" type="audio/mpeg;"/>
              </audio>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>
  <!DOCTYPE html>
<html xmlns = "http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<!-- polyfill -->
	<script src="../inc/shim/Base64.js" type="text/javascript"></script>
	<script src="../inc/shim/Base64binary.js" type="text/javascript"></script>
	<script src="../inc/shim/WebAudioAPI.js" type="text/javascript"></script>
	<!-- midi.js package -->
	<script src="../js/midi/audioDetect.js" type="text/javascript"></script>
	<script src="../js/midi/gm.js" type="text/javascript"></script>
	<script src="../js/midi/loader.js" type="text/javascript"></script>
	<script src="../js/midi/plugin.audiotag.js" type="text/javascript"></script>
	<script src="../js/midi/plugin.webaudio.js" type="text/javascript"></script>
	<script src="../js/midi/plugin.webmidi.js" type="text/javascript"></script>
	<!-- utils -->
	<script src="../js/util/dom_request_xhr.js" type="text/javascript"></script>
	<script src="../js/util/dom_request_script.js" type="text/javascript"></script>
</head>
<body>
<script type="text/javascript">
window.onload = function () {
	MIDI.loadPlugin({
		soundfontUrl: "./soundfont/",
		instrument: "acoustic_grand_piano",
		onprogress: function(state, progress) {
			console.log(state, progress);
		},
		onsuccess: function() {
			var delay = 0; // play one note every quarter second
			var note = 50; // the MIDI note
			var velocity = 127; // how hard the note hits
			// play the note
			MIDI.setVolume(0, 127);
			MIDI.noteOn(0, note, velocity, delay);
			MIDI.noteOff(0, note, delay + 0.75);
		}
	});
};
</script>
</body>
</html>

  <% include partials/message.ejs %>

</body>
