<html>

<head>
  <% include partials/head.ejs %>
  <link href="https://use.fontawesome.com/releases/v5.0.4/css/all.css" rel="stylesheet">
</head>

<body>
  <% include partials/navbar.ejs %>

  <div class="container">

    <!-- Results Page Header -->
    <hgroup class="mb20">
      <h1>Search Results</h1>
      <h2 class="lead" id="searchnum"><strong class="text-danger"><%=data.length%></strong> results were found for your search </h2>
    </hgroup><br>

    <!-- Search Bar -->
    <h4> Search Archive </h4>
    <% include partials/search-bar %>

    <!-- Advanced Search Options -->
    <% include partials/advanced-search.ejs %>

    <!-- List of Results -->
    <table class='table table-hover '>
      <thead>
        <tr>
          <th scope='col'> # </th>
          <th scope='col'> Artist </th>
          <th scope='col'> Track </th>
          <th scope='col'> Tempo </th>
          <th scope='col'> Key </th>
          <th scope='col'> Image </th>
        </tr>
      </thead>

      <!-- Populate Table w/ Query Results -->
      <tbody>
        <% for (i=0; i<data.length; i++) { %>
          <tr class='clickable' style='cursor: pointer;' id="row" link='/archive/archive-entry?_id=<%= data[i]._id%>'>
            <th scope='row'>
              <%= i %>
            </th>
            <td>
              <%= data[i].artistName %>
            </td>
            <td>
              <%= data[i].trackName %>
            </td>
            <td>
              <%= data[i].tempo %>
            </td>
            <td>
              <%= data[i].key %>
            </td>
            <td> <img style='width:75px; height:75px', src='data:image/png;base64, <%= data[i].image %>'> </td>
          <tr>
        <% } %>
      </tbody>
    <table>
  </div>
</div>

<!-- Redirect Page to Archive Entry -->
<script>
  $('.clickable').on('click', (e) => {
    document.location.href = e.currentTarget.getAttribute('link')
  })

  $('.fa').hover(
    (e) => { $(e.target).addClass('fa-spin'); },
    (e) => { $(e.target).removeClass('fa-spin');}
  )
</script>

</body>

</html>
